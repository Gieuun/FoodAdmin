<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>푸드핏 관리자 사이트</title>
<!-- 헤더 링크를 포함한 Thymeleaf 템플릿 -->
<th:block th:include="/fragments/header_link :: header_link"></th:block>
</head>
<body class="hold-transition sidebar-mini layout-fixed">
    <!-- 프리로더 -->
    <th:block th:include="/fragments/preloader :: preloader"></th:block>
    <!-- 네비게이션 바 -->
    <th:block th:include="/fragments/navi :: navi"></th:block>
    <!-- 메인 사이드바 컨테이너 -->
    <th:block th:include="fragments/sidebar :: sidebar"></th:block>
    <!-- .wrapper 전체 래퍼 -->
    <div class="wrapper">
        <!-- 컨텐츠 래퍼. 페이지 콘텐츠 포함 -->
        <div class="content-wrapper">
            <!-- 콘텐츠 헤더 (페이지 헤더) -->
            <div class="content-header">
                <div class="container-fluid">
                    <div class="row mb-2">
                        <div class="col-sm-6">
                            <h1 class="m-0">Dash</h1>
                        </div>
                    </div>
                    <!-- .row -->
                </div>
                <!-- .container-fluid -->
            </div>
            <!-- .content-header -->
            <!-- 메인 콘텐츠 -->
            <section class="content">
                <div class="container-fluid">
                    <!-- 작은 박스 (통계 박스) -->
                    <div class="row">
                        <div class="col-lg-3 col-6">
                            <!-- 작은 박스 -->
                            <div class="small-box bg-success">
                                <div class="inner">
                                    <h3>
                                        <span id="visitorCount" style="font-size: 38px">명</span>
                                    </h3>
                                    <p>총 누적방문자 (명)</p>
                                </div>
                                <div class="icon">
                                    <i class="ion ion-stats-bars"></i>
                                </div>                                
                            </div>
                        </div>
                        <!-- ./col -->
                        <div class="col-lg-3 col-6">
                            <!-- 작은 박스 -->
                            <div class="small-box bg-warning">
                                <div class="inner">
                                    <h3>
                                        <span id="countMember" style="font-size: 38px">명</span>
                                    </h3>
                                    <p>총 회원수</p>
                                </div>
                                <div class="icon">
                                    <i class="ion ion-person-add"></i>
                                </div>
                            </div>
                        </div>
                        <!-- ./col -->                        
                    </div>
                    <!-- .row -->
                    <!-- 메인 로우 -->
                    <div class="row">
                        <!-- 왼쪽 칼럼 -->
                        <section class="col-lg-7 connectedSortable">
                            <!-- 탭이 있는 차트 -->
                        </section>
                        <!-- .Left col -->
                        <!-- 오른쪽 칼럼 (위젯 정렬 가능하게 ID 추가) -->
                    </div>
                    <!-- .row (main row) -->

                </div>
                <!-- .container-fluid -->
            </section>
            <!-- .content -->
        </div>
        <!-- .content-wrapper -->
        <!-- 컨트롤 사이드바 -->
        <aside class="control-sidebar control-sidebar-dark">
            <!-- 컨트롤 사이드바 콘텐츠 -->
        </aside>
        <!-- .control-sidebar -->
    </div>
    <!-- .wrapper -->
    <!-- 푸터 포함 -->
    <th:block th:include="/fragments/footer :: footer"></th:block>
    <!-- 푸터 링크 포함 -->
    <th:block th:include="/fragments/footer_link :: footer_link"></th:block>
</body>
</html>
<script type="text/javascript">
    // 방문자 수를 가져와서 출력하는 스크립트
    fetch('/api/visitorCount')
        .then(response => response.json())
        .then(data => {
            document.getElementById('visitorCount').innerText = data;
        })
        .catch(error => console.error('Error fetching visitor count:', error));
    
    fetch('/api/countMember')
    .then(response => response.json())
    .then(data => {
        document.getElementById('countMember').innerText = data;
    })
    .catch(error => console.error('Error fetching visitor count:', error));
</script>
